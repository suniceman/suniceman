<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <meta name="description" content="My name is Silence Su. I’m a full-time backend developer.">
    <meta name="keywords"  content="suniceman, Suniceman Blog, 博客, 个人网站, 互联网, 后端, Web, JavaScript, 前端, 设计">
    <meta name="theme-color" content="#000000">
    
    <!-- Open Graph -->
    <meta property="og:title" content="原生js实现瀑布流及微信小程序中使用左右两列实现瀑布流 - Suniceman | Silence Su">
    
    <meta property="og:type" content="article">
    <meta property="og:description" content="
  使用css实现瀑布流并不实用，因为潮汕市实现的瀑布流都是以列来排列的，这里记录下用js实现瀑布流，以及微信小程序中使用左右两列来实现瀑布流


">
    
    <meta property="article:published_time" content="2017-08-03T20:00:00Z">
    
    
    <meta property="article:author" content="Silence">
    
    
    <meta property="article:tag" content="javaScript">
    
    <meta property="article:tag" content="小程序">
    
    
    <meta property="og:image" content="http://localhost:4000/img/avatar-hux-ny.jpg">
    <meta property="og:url" content="http://localhost:4000/2017/08/03/%E5%8E%9F%E7%94%9Fjs%E5%AE%9E%E7%8E%B0%E7%80%91%E5%B8%83%E6%B5%81%E5%8F%8A%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%B7%A6%E5%8F%B3%E4%B8%A4%E5%88%97%E5%AE%9E%E7%8E%B0%E7%80%91%E5%B8%83%E6%B5%81/">
    <meta property="og:site_name" content="Suniceman | Silence Su">
    
    <title>原生js实现瀑布流及微信小程序中使用左右两列实现瀑布流 - Suniceman | Silence Su</title>

    <!-- Web App Manifest -->
    <link rel="manifest" href="/pwa/manifest.json">

    <!-- Favicon -->
    <link rel="shortcut icon" href="/img/favicon.ico">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="http://localhost:4000/2017/08/03/%E5%8E%9F%E7%94%9Fjs%E5%AE%9E%E7%8E%B0%E7%80%91%E5%B8%83%E6%B5%81%E5%8F%8A%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%B7%A6%E5%8F%B3%E4%B8%A4%E5%88%97%E5%AE%9E%E7%8E%B0%E7%80%91%E5%B8%83%E6%B5%81/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->

<nav class="navbar navbar-default navbar-custom navbar-fixed-top">

    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Suniceman Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                    
                    
                    
                    <li>
                        <a href="/about/">About</a>
                    </li>
                    
                    
                    
                    <li>
                        <a href="/archive/">Archive</a>
                    </li>
                    
                    
                    
                    
                    
                    <li>
                        <a href="/portfolio/">Portfolio</a>
                    </li>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    var __HuxNav__ = {
        close: function(){
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        },
        open: function(){
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }

    // Bind Event
    $toggle.addEventListener('click', function(e){
        if ($navbar.className.indexOf('in') > 0) {
            __HuxNav__.close()
        }else{
            __HuxNav__.open()
        }
    })

    /**
     * Since Fastclick is used to delegate 'touchstart' globally
     * to hack 300ms delay in iOS by performing a fake 'click',
     * Using 'e.stopPropagation' to stop 'touchstart' event from 
     * $toggle/$collapse will break global delegation.
     * 
     * Instead, we use a 'e.target' filter to prevent handler
     * added to document close HuxNav.  
     *
     * Also, we use 'click' instead of 'touchstart' as compromise
     */
    document.addEventListener('click', function(e){
        if(e.target == $toggle) return;
        if(e.target.className == 'icon-bar') return;
        __HuxNav__.close();
    })
</script>


    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.jpg" width="0" height="0"> -->
<!-- <img src="/" width="0" height="0"> -->

<!-- Post Header -->



<style type="text/css">
    header.intro-header{
        position: relative;
        background-image: url('/');
        background: linear-gradient(to right, #404040, #404040);;
    }

    
</style>

<header class="intro-header" >

    <div class="header-mask"></div>
    
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/archive/?tag=javaScript" title="javaScript">javaScript</a>
                        
                        <a class="tag" href="/archive/?tag=%E5%B0%8F%E7%A8%8B%E5%BA%8F" title="小程序">小程序</a>
                        
                    </div>
                    <h1>原生js实现瀑布流及微信小程序中使用左右两列实现瀑布流</h1>
                    
                    <h2 class="subheading">两列实现瀑布流</h2>
                    <span class="meta">Posted by Silence on August 3, 2017</span>
                </div>
            </div>
        </div>
    </div>
</header>






<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <!-- Multi-Lingual -->
                

				<blockquote>
  <p>使用css实现瀑布流并不实用，因为潮汕市实现的瀑布流都是以列来排列的，这里记录下用js实现瀑布流，以及微信小程序中使用左右两列来实现瀑布流</p>
</blockquote>

<h2 id="效果图">效果图</h2>

<p><img src="/img/clipbord.png" alt="io" /></p>

<h2 id="原生js实现瀑布流">原生js实现瀑布流</h2>

<ul>
  <li>html文件</li>
</ul>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"root"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"item"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"itemImg"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"../images/1.jpeg"</span> <span class="na">alt=</span><span class="s">""</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"item"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"itemImg"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"../images/3.jpeg"</span> <span class="na">alt=</span><span class="s">""</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"item"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"itemImg"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"../images/2.jpg"</span> <span class="na">alt=</span><span class="s">""</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>
    <p>图片可以自己找点替换下就可以了</p>
  </li>
  <li>
    <p>css文件</p>
  </li>
</ul>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="o">*</span><span class="p">{</span>
    <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
    <span class="nl">padding</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="nf">#root</span><span class="p">{</span>
    <span class="nl">position</span><span class="p">:</span> <span class="nb">relative</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.item</span><span class="p">{</span>
    <span class="nl">float</span><span class="p">:</span> <span class="nb">left</span><span class="p">;</span>
    <span class="nl">padding</span><span class="p">:</span> <span class="m">5px</span><span class="p">;</span>
<span class="p">}</span>
<span class="c">/* 添加阴影的时候，加上border会显得更加有点悬浮感 */</span>
<span class="nc">.itemImg</span><span class="p">{</span>
    <span class="nl">padding</span><span class="p">:</span> <span class="m">5px</span><span class="p">;</span>
    <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="m">#ccc</span><span class="p">;</span>
    <span class="nl">box-shadow</span><span class="p">:</span> <span class="m">0</span> <span class="m">0</span> <span class="m">5px</span> <span class="m">#ccc</span><span class="p">;</span>
    <span class="nl">border-radius</span><span class="p">:</span> <span class="m">5px</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.itemImg</span> <span class="nt">img</span><span class="p">{</span>
    <span class="nl">width</span><span class="p">:</span> <span class="m">230px</span><span class="p">;</span>
    <span class="nl">height</span><span class="p">:</span> <span class="nb">auto</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>js文件</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
</pre></td><td class="rouge-code"><pre><span class="nb">window</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

    <span class="cm">/* 计算图片列数及获取最小高度图片 */</span>
    <span class="nx">generateImg</span><span class="p">(</span><span class="s1">'root'</span><span class="p">,</span> <span class="s1">'item'</span><span class="p">);</span>

    <span class="cm">/* 对窗口大小改变进行监听，大小改变则重新布局 */</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'resize'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">generateImg</span><span class="p">(</span><span class="s1">'root'</span><span class="p">,</span> <span class="s1">'item'</span><span class="p">)</span>
    <span class="p">});</span>

    <span class="cm">/* 图片对象 */</span>
    <span class="kd">let</span> <span class="nx">imgData</span> <span class="o">=</span> <span class="p">{</span>
        <span class="na">images</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">"src"</span><span class="p">:</span><span class="s2">"23.png"</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">"src"</span><span class="p">:</span><span class="s2">"22.png"</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">"src"</span><span class="p">:</span><span class="s2">"2.jpg"</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">"src"</span><span class="p">:</span><span class="s2">"4.jpg"</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s2">"src"</span><span class="p">:</span><span class="s2">"7.jpg"</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">};</span>
    <span class="cm">/* 对滚动监听 */</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">'scroll'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">checkIsScroll</span><span class="p">())</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="nx">rootElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'root'</span><span class="p">);</span>
            <span class="cm">/* 利用documentFragment来创建 */</span>
            <span class="c1">// let documentFragment = document.createDocumentFragment();</span>
            <span class="kd">let</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">imgData</span><span class="p">.</span><span class="nx">images</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>

            <span class="cm">/* 循环创建图片组 */</span>
            <span class="k">for</span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">let</span> <span class="nx">itemElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'div'</span><span class="p">);</span>
                <span class="nx">itemElement</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">'item'</span><span class="p">;</span>
                <span class="nx">rootElement</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">itemElement</span><span class="p">);</span>
                <span class="kd">let</span> <span class="nx">itemImgElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'div'</span><span class="p">);</span>
                <span class="nx">itemImgElement</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">'itemImg'</span><span class="p">;</span>
                <span class="nx">itemElement</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">itemImgElement</span><span class="p">);</span>
                <span class="kd">let</span> <span class="nx">itemImg</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">'img'</span><span class="p">);</span>
                <span class="nx">itemImg</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssText</span> <span class="o">=</span> <span class="s1">'opacity: 0; transform:scale(0)'</span><span class="p">;</span>
                <span class="nx">itemImg</span><span class="p">.</span><span class="nx">src</span> <span class="o">=</span> <span class="s2">"../images/"</span> <span class="o">+</span> <span class="nx">imgData</span><span class="p">.</span><span class="nx">images</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">src</span><span class="p">;</span>
                <span class="nx">itemImgElement</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">itemImg</span><span class="p">);</span>
                <span class="c1">//  documentFragment.appendChild(itemElement);</span>

                <span class="cm">/* 在1秒后让图片显示出来 */</span>
                <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">img</span><span class="p">){</span>
                    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
                        <span class="nx">img</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssText</span><span class="o">=</span><span class="s2">"opacity:1;transform:scale(1)"</span><span class="p">;</span>
                    <span class="p">},</span><span class="mi">1000</span><span class="p">);</span>
                <span class="p">})(</span><span class="nx">itemImg</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="c1">// rootElement.appendChild(documentFragment);</span>
            <span class="nx">generateImg</span><span class="p">(</span><span class="s1">'root'</span><span class="p">,</span> <span class="s1">'item'</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">};</span>

<span class="cm">/* 计算图片列数及获取最小高度图片 */</span>
<span class="kd">function</span> <span class="nx">generateImg</span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span> <span class="nx">content</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* 获取父元素及其所以节点内容 */</span>
    <span class="kd">let</span> <span class="nx">parentElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
    <span class="kd">let</span> <span class="nx">childContent</span> <span class="o">=</span> <span class="nx">getChildElement</span><span class="p">(</span><span class="nx">parentElement</span><span class="p">,</span> <span class="nx">content</span><span class="p">);</span>

    <span class="cm">/* 获取图片宽度 */</span>
    <span class="kd">let</span> <span class="nx">imgWidth</span> <span class="o">=</span> <span class="nx">childContent</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">offsetWidth</span><span class="p">;</span>
    <span class="cm">/* 获取一行图片形成的列数 */</span>
    <span class="kd">let</span> <span class="nx">imgColumn</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">clientWidth</span> <span class="o">/</span> <span class="nx">imgWidth</span><span class="p">);</span>
    <span class="cm">/* 重新设置父级容器的宽度 */</span>
    <span class="nx">parentElement</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssText</span> <span class="o">=</span> <span class="s1">'width:'</span> <span class="o">+</span> <span class="nx">imgColumn</span> <span class="o">*</span> <span class="nx">imgWidth</span> <span class="o">+</span> <span class="s1">'px;margin:0 auto'</span><span class="p">;</span>

    <span class="cm">/* 存储每个图片的高度，以此来找到最小图片高 */</span>
    <span class="kd">let</span> <span class="nx">imgHeightArray</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="kd">let</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">childContent</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/* i&lt;imgColumn统计每一行的图片高度 */</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">imgColumn</span><span class="p">)</span> <span class="p">{</span>
            <span class="cm">/* 防止用户改变窗口大小时，内容样式错乱 */</span>
            <span class="nx">childContent</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">cssText</span> <span class="o">=</span> <span class="s1">''</span><span class="p">;</span>
            <span class="nx">imgHeightArray</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">childContent</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">offsetHeight</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="cm">/* 如果不是这一行的，则找到最小值和最小值的索引值 */</span>
            <span class="kd">let</span> <span class="nx">minHeight</span> <span class="o">=</span> <span class="nx">getMinImgHeight</span><span class="p">(</span><span class="nx">imgHeightArray</span><span class="p">);</span>
            <span class="kd">let</span> <span class="nx">minHeightIndex</span> <span class="o">=</span> <span class="nx">getMinHeightIndex</span><span class="p">(</span><span class="nx">imgHeightArray</span><span class="p">,</span> <span class="nx">minHeight</span><span class="p">);</span>
            <span class="cm">/* 对这个图片设置位置 */</span>
            <span class="nx">childContent</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="s1">'absolute'</span><span class="p">;</span>
            <span class="nx">childContent</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span> <span class="o">=</span> <span class="nx">minHeight</span> <span class="o">+</span> <span class="s1">'px'</span><span class="p">;</span>
            <span class="nx">childContent</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span> <span class="o">=</span> <span class="nx">childContent</span><span class="p">[</span><span class="nx">minHeightIndex</span><span class="p">].</span><span class="nx">offsetLeft</span> <span class="o">+</span> <span class="s1">'px'</span><span class="p">;</span>
            <span class="cm">/* 更换此时的最小高度 */</span>
            <span class="nx">imgHeightArray</span><span class="p">[</span><span class="nx">minHeightIndex</span><span class="p">]</span> <span class="o">=</span> <span class="nx">childContent</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">offsetHeight</span> <span class="o">+</span> <span class="nx">minHeight</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/* 检测滚动是否达到了可视区 */</span>
<span class="kd">function</span> <span class="nx">checkIsScroll</span><span class="p">()</span> <span class="p">{</span>
    <span class="cm">/* 获取root根节点 */</span>
    <span class="kd">let</span> <span class="nx">parentElement</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'root'</span><span class="p">);</span>
    <span class="cm">/* 获取父元素下的类名为box的元素节点 */</span>
    <span class="kd">let</span> <span class="nx">childContent</span> <span class="o">=</span> <span class="nx">getChildElement</span><span class="p">(</span><span class="nx">parentElement</span><span class="p">,</span> <span class="s1">'item'</span><span class="p">);</span>

    <span class="cm">/* 获取最后一个元素的高度 */</span>
    <span class="kd">let</span> <span class="nx">lastElementHeight</span> <span class="o">=</span> <span class="nx">childContent</span><span class="p">[</span><span class="nx">childContent</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">offsetTop</span><span class="p">;</span>
    <span class="cm">/* 获取滚动的距离 */</span>
    <span class="kd">let</span> <span class="nx">scrollTopSpace</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">scrollTop</span><span class="p">;</span>
    <span class="cm">/* 获取可视区的距离 */</span>
    <span class="kd">let</span> <span class="nx">clientHeight</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">clientHeight</span> <span class="o">||</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">clientHeight</span><span class="p">;</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">lastElementHeight</span> <span class="o">&gt;</span> <span class="nx">scrollTopSpace</span> <span class="o">+</span> <span class="nx">clientHeight</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cm">/* 获取子节点的所有内容 */</span>
<span class="kd">function</span> <span class="nx">getChildElement</span><span class="p">(</span><span class="nx">parentElement</span><span class="p">,</span> <span class="nx">content</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* 存储元素信息 */</span>
    <span class="kd">let</span> <span class="nx">elementArray</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="cm">/* 获取父元素下的所有节点信息 */</span>
    <span class="kd">let</span> <span class="nx">allElement</span> <span class="o">=</span> <span class="nx">parentElement</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="s1">'*'</span><span class="p">);</span>
    <span class="kd">let</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">allElement</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/* 找到对应的类名 */</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">allElement</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">className</span> <span class="o">===</span> <span class="nx">content</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">elementArray</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">allElement</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">elementArray</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* 获取图片最小高度 */</span>
<span class="kd">function</span> <span class="nx">getMinImgHeight</span><span class="p">(</span><span class="nx">heightArray</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">heightArray</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">minHeight</span> <span class="o">=</span> <span class="nx">heightArray</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">minHeight</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">minHeight</span><span class="p">,</span> <span class="nx">heightArray</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">minHeight</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/* 获取图片最小高度的索引值 */</span>
<span class="kd">function</span> <span class="nx">getMinHeightIndex</span><span class="p">(</span><span class="nx">heightArray</span><span class="p">,</span> <span class="nx">minHeight</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">length</span> <span class="o">=</span> <span class="nx">heightArray</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">heightArray</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">==</span> <span class="nx">minHeight</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">i</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="微信小程序中实现瀑布流">微信小程序中实现瀑布流</h2>

<ul>
  <li>效果图</li>
</ul>

<p><img src="/img/weapp.png" alt="io" /></p>

<ul>
  <li>wxml文件</li>
</ul>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;view</span> <span class="na">class=</span><span class="s">"cateCommodity"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;view</span> <span class="na">class=</span><span class="s">"leftContainer"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;block</span> <span class="na">wx:for=</span><span class="s">""</span> <span class="na">wx:key=</span><span class="s">""</span><span class="nt">&gt;</span>
      <span class="nt">&lt;view</span> <span class="na">class=</span><span class="s">"cateItem"</span> <span class="na">wx:if=</span><span class="s">""</span><span class="nt">&gt;</span>
        <span class="nt">&lt;view</span> <span class="na">class=</span><span class="s">"item"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;image</span> <span class="na">src=</span><span class="s">""</span> <span class="na">class=</span><span class="s">"itemImg"</span> <span class="na">mode=</span><span class="s">"widthFix"</span><span class="nt">&gt;&lt;/image&gt;</span>
          <span class="nt">&lt;view</span> <span class="na">class=</span><span class="s">"title"</span><span class="nt">&gt;&lt;/view&gt;</span>
        <span class="nt">&lt;/view&gt;</span>
      <span class="nt">&lt;/view&gt;</span>
    <span class="nt">&lt;/block&gt;</span>
  <span class="nt">&lt;/view&gt;</span>
  <span class="nt">&lt;view</span> <span class="na">class=</span><span class="s">"rightContainer"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;block</span> <span class="na">wx:for=</span><span class="s">""</span> <span class="na">wx:key=</span><span class="s">""</span><span class="nt">&gt;</span>
      <span class="nt">&lt;view</span> <span class="na">class=</span><span class="s">"cateItem"</span> <span class="na">wx:if=</span><span class="s">""</span><span class="nt">&gt;</span>
        <span class="nt">&lt;view</span> <span class="na">class=</span><span class="s">"item"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;image</span> <span class="na">src=</span><span class="s">""</span> <span class="na">class=</span><span class="s">"itemImg"</span> <span class="na">mode=</span><span class="s">"widthFix"</span><span class="nt">&gt;&lt;/image&gt;</span>
          <span class="nt">&lt;view</span> <span class="na">class=</span><span class="s">"title"</span><span class="nt">&gt;&lt;/view&gt;</span>
        <span class="nt">&lt;/view&gt;</span>
      <span class="nt">&lt;/view&gt;</span>
    <span class="nt">&lt;/block&gt;</span>
  <span class="nt">&lt;/view&gt;</span>
<span class="nt">&lt;/view&gt;</span>
<span class="nt">&lt;view</span> <span class="na">class=</span><span class="s">"skipTop"</span> <span class="na">catchtap=</span><span class="s">"skipTop"</span> <span class="na">wx:if=</span><span class="s">""</span><span class="nt">&gt;</span>
  <span class="nt">&lt;image</span> <span class="na">src=</span><span class="s">"http://boweisou.oss-cn-shenzhen.aliyuncs.com/images/0/2018/11/ZBtqujbbcGjBDgjt0bbJqbTuGqq0z8.png"</span><span class="nt">&gt;&lt;/image&gt;</span>
<span class="nt">&lt;/view&gt;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>wxss文件</li>
</ul>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre></td><td class="rouge-code"><pre><span class="nt">page</span><span class="p">{</span>
  <span class="nl">background</span><span class="p">:</span> <span class="m">#f6f6f6</span><span class="p">;</span>
<span class="p">}</span>
<span class="c">/* 最外层 */</span>
<span class="nc">.cateCommodity</span> <span class="p">{</span>
  <span class="nl">display</span><span class="p">:</span> <span class="n">flex</span><span class="p">;</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">20</span><span class="n">rpx</span> <span class="m">28</span><span class="n">rpx</span> <span class="m">8</span><span class="n">rpx</span><span class="p">;</span>
  <span class="nl">box-sizing</span><span class="p">:</span> <span class="n">border-box</span><span class="p">;</span>
  <span class="nl">font-size</span><span class="p">:</span> <span class="m">28</span><span class="n">rpx</span><span class="p">;</span>
<span class="p">}</span>
<span class="c">/* 左右两个容器 */</span>
<span class="nc">.leftContainer</span><span class="p">{</span>
  <span class="nl">display</span><span class="p">:</span> <span class="n">flex</span><span class="p">;</span>
  <span class="nl">margin-right</span><span class="p">:</span> <span class="m">22</span><span class="n">rpx</span><span class="p">;</span>
  <span class="nl">flex-direction</span><span class="p">:</span> <span class="n">column</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.rightContainer</span><span class="p">{</span>
  <span class="nl">display</span><span class="p">:</span> <span class="n">flex</span><span class="p">;</span>
  <span class="nl">flex-direction</span><span class="p">:</span> <span class="n">column</span><span class="p">;</span>
<span class="p">}</span>
<span class="c">/* 图片容器 */</span>
<span class="nc">.cateItem</span> <span class="p">{</span>
  <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">20</span><span class="n">rpx</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.item</span><span class="p">{</span>
  <span class="nl">padding</span><span class="p">:</span> <span class="m">20</span><span class="n">rpx</span> <span class="m">22</span><span class="n">rpx</span><span class="p">;</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">335</span><span class="n">rpx</span><span class="p">;</span>
  <span class="nl">box-sizing</span><span class="p">:</span> <span class="n">border-box</span><span class="p">;</span>
  <span class="nl">background</span><span class="p">:</span> <span class="m">#fff</span><span class="p">;</span>
  <span class="nl">border-radius</span><span class="p">:</span> <span class="m">6</span><span class="n">rpx</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.itemImg</span><span class="p">{</span>
  <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">14</span><span class="n">rpx</span><span class="p">;</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
  <span class="nl">vertical-align</span><span class="p">:</span> <span class="nb">middle</span><span class="p">;</span>
  <span class="nl">border-radius</span><span class="p">:</span> <span class="m">6</span><span class="n">rpx</span><span class="p">;</span>
<span class="p">}</span>
<span class="nc">.title</span><span class="p">{</span>
  <span class="nl">display</span><span class="p">:</span> <span class="n">-webkit-box</span><span class="p">;</span>
  <span class="nl">overflow</span><span class="p">:</span> <span class="nb">hidden</span><span class="p">;</span>
  <span class="nl">-webkit-line-clamp</span><span class="p">:</span> <span class="m">2</span><span class="p">;</span>
  <span class="nl">-webkit-box-orient</span><span class="p">:</span> <span class="n">vertical</span><span class="p">;</span>
  <span class="nl">line-height</span><span class="p">:</span> <span class="m">1.5</span><span class="p">;</span>
<span class="p">}</span>
<span class="c">/* 返回顶部 */</span>
<span class="nc">.skipTop</span> <span class="p">{</span>
  <span class="nl">position</span><span class="p">:</span> <span class="nb">fixed</span><span class="p">;</span>
  <span class="nl">bottom</span><span class="p">:</span> <span class="m">30</span><span class="n">rpx</span><span class="p">;</span>
  <span class="nl">right</span><span class="p">:</span> <span class="m">20</span><span class="n">rpx</span><span class="p">;</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">90</span><span class="n">rpx</span><span class="p">;</span>
  <span class="nl">height</span><span class="p">:</span> <span class="m">90</span><span class="n">rpx</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.skipTop</span> <span class="nt">image</span> <span class="p">{</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
  <span class="nl">height</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
  <span class="nl">vertical-align</span><span class="p">:</span> <span class="nb">middle</span><span class="p">;</span>
<span class="p">}</span>

</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>js文件</li>
</ul>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
</pre></td><td class="rouge-code"><pre>
<span class="nx">Page</span><span class="p">({</span>
  <span class="na">data</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">imageArray</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="na">src</span><span class="p">:</span> <span class="s1">'../../images/avatar.jpeg'</span><span class="p">,</span>
        <span class="na">title</span><span class="p">:</span> <span class="s1">'现代新中式创意陶瓷简约摆件客厅家居玄关软装饰品家居酒柜盘子'</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="na">src</span><span class="p">:</span> <span class="s1">'../../images/avatar3.jpg'</span><span class="p">,</span>
        <span class="na">title</span><span class="p">:</span> <span class="s1">'秋冬季新款2018休闲运动服套装女士韩版金丝绒卫衣加绒加厚两件套'</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="na">src</span><span class="p">:</span> <span class="s1">'../../images/avatar4.jpeg'</span><span class="p">,</span>
        <span class="na">title</span><span class="p">:</span> <span class="s1">'女童床上用品四件套公主房1.2m床品纯棉女孩1.8儿童床单三件套1.5'</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="na">src</span><span class="p">:</span> <span class="s1">'../../images/avatar7.jpg'</span><span class="p">,</span>
        <span class="na">title</span><span class="p">:</span> <span class="s1">'婴儿床圆床蚊帐落地款宝宝椭圆床蚊帐支架款儿童床蚊帐BB床小蚊帐'</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="na">src</span><span class="p">:</span> <span class="s1">'../../images/avatar9.jpeg'</span><span class="p">,</span>
        <span class="na">title</span><span class="p">:</span> <span class="s1">'包邮动感158T速滑鞋轮滑鞋竞速鞋高端碳纤鞋 固定码 专业定制'</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="na">src</span><span class="p">:</span> <span class="s1">'../../images/logo7.jpg'</span><span class="p">,</span>
        <span class="na">title</span><span class="p">:</span> <span class="s1">'Infanton落地婴儿床蚊帐带支架儿童床蚊帐宝宝蚊帐婴童蚊帐'</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="na">src</span><span class="p">:</span> <span class="s1">'../../images/logo6.jpg'</span><span class="p">,</span>
        <span class="na">title</span><span class="p">:</span> <span class="s1">'老A轮滑 米高seba hl碳纤版SEBA HL CARBON 平花鞋刹车鞋全能鞋'</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="na">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="na">src</span><span class="p">:</span> <span class="s1">'../../images/logo.jpeg'</span><span class="p">,</span>
        <span class="na">title</span><span class="p">:</span> <span class="s1">'洋洋法代 sandro 17秋冬 一粒扣羊毛长款大衣外套EKIN M9575H'</span>
      <span class="p">},</span>
    <span class="p">],</span>
    <span class="na">showTopImage</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="nx">onPageScroll</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="cm">/* 利用两个条件，防止重复的进行setData操作 */</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">&gt;</span> <span class="mi">300</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">showTopImage</span> <span class="o">==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span>
        <span class="na">showTopImage</span><span class="p">:</span> <span class="kc">true</span>
      <span class="p">})</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">scrollTop</span> <span class="o">&lt;</span> <span class="mi">300</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">showTopImage</span> <span class="o">==</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span>
        <span class="na">showTopImage</span><span class="p">:</span> <span class="kc">false</span>
      <span class="p">})</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="nx">skipTop</span><span class="p">()</span> <span class="p">{</span>
    <span class="cm">/* 返回顶部 */</span>
    <span class="nx">wx</span><span class="p">.</span><span class="nx">pageScrollTo</span><span class="p">({</span>
      <span class="na">scrollTop</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="na">duration</span><span class="p">:</span> <span class="mi">300</span>
    <span class="p">});</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span>
      <span class="na">showTopImage</span><span class="p">:</span> <span class="kc">false</span>
    <span class="p">});</span>
  <span class="p">},</span>
  <span class="na">onReachBottom</span><span class="p">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">temporaryArray</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">imageArray</span><span class="p">;</span>
    <span class="nx">temporaryArray</span><span class="p">.</span><span class="nx">push</span><span class="p">(...</span><span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">imageArray</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">({</span>
      <span class="na">imageArray</span><span class="p">:</span> <span class="nx">temporaryArray</span>
    <span class="p">})</span>
  <span class="p">},</span>
<span class="p">})</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>左右两列实现瀑布流其实就是对同一数组进行了两次渲染，只是把其中的一半给隐藏了</li>
</ul>


                <hr style="visibility: hidden;">
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2017/06/20/yii2-%E6%B7%BB%E5%8A%A0%E6%A8%A1%E5%9D%97/" data-toggle="tooltip" data-placement="top" title="Yii2 添加模块">
                        Previous<br>
                        <span>Yii2 添加模块</span>
                        </a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2017/09/20/Docker%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%AE%9E%E8%B7%B5/" data-toggle="tooltip" data-placement="top" title="Docker 学习与实践">
                        Next<br>
                        <span>Docker 学习与实践</span>
                        </a>
                    </li>
                    
                </ul>
                <hr style="visibility: hidden;">

                
                <!-- disqus 评论框 start -->
                <div class="comment">
                    <div id="disqus_thread" class="disqus-thread"></div>
                </div>
                <!-- disqus 评论框 end -->
                

                
            </div>

    <!-- Side Catalog Container -->
        
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
        

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                


<section>
    
        <hr class="hidden-sm hidden-xs">
    
    <h5><a href="/archive/">FEATURED TAGS</a></h5>
    <div class="tags">
        
        
        
        </a>
        
        
                <a data-sort="0017" 
                    href="/archive/?tag=Java"
                    title="Java"
                    rel="2">Java</a>
        
                <a data-sort="0014" 
                    href="/archive/?tag=%E6%95%B0%E6%8D%AE%E5%BA%93"
                    title="数据库"
                    rel="5">数据库</a>
        
                <a data-sort="0016" 
                    href="/archive/?tag=Javascript"
                    title="Javascript"
                    rel="3">Javascript</a>
        
                <a data-sort="0016" 
                    href="/archive/?tag=mongodb"
                    title="mongodb"
                    rel="3">mongodb
    </div>
</section>


                <!-- Friends Blog -->
                
<hr>
<h5>FRIENDS</h5>
<ul class="list-inline">
  
  <li><a href="http://suniceman.github.io">Suniceman</a></li>
  
</ul>

            </div>
        </div>
    </div>
</article>

<!-- add support for mathjax by voleking-->






<!-- disqus 公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = "suniceman";
    var disqus_identifier = "/2017/08/03/原生js实现瀑布流及微信小程序中使用左右两列实现瀑布流";
    var disqus_url = "http://localhost:4000/2017/08/03/%E5%8E%9F%E7%94%9Fjs%E5%AE%9E%E7%8E%B0%E7%80%91%E5%B8%83%E6%B5%81%E5%8F%8A%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%B7%A6%E5%8F%B3%E4%B8%A4%E5%88%97%E5%AE%9E%E7%8E%B0%E7%80%91%E5%B8%83%E6%B5%81/";

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<!-- disqus 公共JS代码 end -->




<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'always',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <!-- SNS Link -->
                


<ul class="list-inline text-center">


  
  
  <li>
    <a href="https://twitter.com/suniceman">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
  <li>
    <a target="_blank" href="https://www.zhihu.com/people/suniceman">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa  fa-stack-1x fa-inverse">知</i>
      </span>
    </a>
  </li>
  
  
  <li>
    <a target="_blank" href="http://weibo.com/suniceman">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
  
  <li>
    <a target="_blank" href="https://github.com/suniceman">
      <span class="fa-stack fa-lg">
        <i class="fa fa-circle fa-stack-2x"></i>
        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
      </span>
    </a>
  </li>
  
  
</ul>

                <p class="copyright text-muted">
                    Copyright &copy; Suniceman Blog 2019
                    <br>
                    Powered by <a href="http://suniceman.github.io">Suniceman Blog</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=suniceman&repo=suniceman.github.io&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<!-- Currently, only navbar scroll-down effect at desktop still depends on this -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>

<!-- Service Worker -->

<script src="/js/snackbar.js "></script>
<script src="/js/sw-registration.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!--
     Because of the native support for backtick-style fenced code blocks
     right within the Markdown is landed in Github Pages,
     From V1.6, There is no need for Highlight.js,
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/
     - https://github.com/jneen/rouge/wiki/list-of-supported-languages-and-lexers
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->





<!--fastClick.js -->
<script>
    async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->



<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = '3bca1d38b47f9792582693607f23e199';

    // Originial
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?" + _baId;
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
</script>



<!-- Side Catalog -->

<script type="text/javascript">
    function generateCatalog (selector) {

        // interop with multilangual
        if ('' == 'true') {
            _containerSelector = 'div.post-container.active'
        } else {
            _containerSelector = 'div.post-container'
        }

        // init
        var P = $(_containerSelector),a,n,t,l,i,c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        // clean
        $(selector).html('')

        // appending
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#"+$(this).prop('id');
            t = $(this).text();
            c = $('<a href="'+i+'" rel="nofollow">'+t+'</a>');
            l = $('<li class="'+n+'_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    // toggle side catalog
    $(".catalog-toggle").click((function(e){
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    /*
     * Doc: https://github.com/davist11/jQuery-One-Page-Nav
     * Fork by Hux to support padding
     */
    async("/js/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>



<!-- Multi-Lingual -->




<!-- Image to hack wechat -->
<img src="/img/icon_wechat.jpg" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
